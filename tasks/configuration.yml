- name: ensure ipv4 forwarding is enabled
  sysctl:
    name: net.ipv4.ip_forward
    value: 1
    sysctl_set: yes
    state: present
    reload: yes
  ignore_errors: yes
  tags:
    - shorewall

- name: ensure shorewall is configured
  template:
    src: "etc/shorewall/{{ item }}.j2"
    dest: "{{ dubzland_shorewall_configuration_root }}/{{ item }}"
    owner: root
    group: root
    mode: 0644
  with_items:
    - interfaces
    - policy
    - zones
    - snat
    - rules
  notify:
    - restart shorewall
  tags:
    - shorewall
